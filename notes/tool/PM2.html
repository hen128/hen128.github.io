<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PM2 | hen&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <meta name="description" content="...">
    
    <link rel="preload" href="/assets/css/0.styles.7da46759.css" as="style"><link rel="preload" href="/assets/js/app.34c958b8.js" as="script"><link rel="preload" href="/assets/js/2.72a95a92.js" as="script"><link rel="preload" href="/assets/js/21.d320b7b1.js" as="script"><link rel="prefetch" href="/assets/js/10.292e92ae.js"><link rel="prefetch" href="/assets/js/11.74a963c8.js"><link rel="prefetch" href="/assets/js/12.abb68325.js"><link rel="prefetch" href="/assets/js/13.ac2e8783.js"><link rel="prefetch" href="/assets/js/14.5d52a911.js"><link rel="prefetch" href="/assets/js/15.d5db5e12.js"><link rel="prefetch" href="/assets/js/16.f894da6d.js"><link rel="prefetch" href="/assets/js/17.4530d172.js"><link rel="prefetch" href="/assets/js/18.f28eef22.js"><link rel="prefetch" href="/assets/js/19.a1f40a50.js"><link rel="prefetch" href="/assets/js/20.506558d6.js"><link rel="prefetch" href="/assets/js/22.be33261c.js"><link rel="prefetch" href="/assets/js/23.9e12513e.js"><link rel="prefetch" href="/assets/js/24.f6804ec1.js"><link rel="prefetch" href="/assets/js/25.1e480bdc.js"><link rel="prefetch" href="/assets/js/26.8e77d200.js"><link rel="prefetch" href="/assets/js/27.8f5c2108.js"><link rel="prefetch" href="/assets/js/28.eb8a2261.js"><link rel="prefetch" href="/assets/js/29.bc55e51d.js"><link rel="prefetch" href="/assets/js/3.31a5e5ef.js"><link rel="prefetch" href="/assets/js/30.39eba8db.js"><link rel="prefetch" href="/assets/js/31.53f16867.js"><link rel="prefetch" href="/assets/js/4.508b5bcd.js"><link rel="prefetch" href="/assets/js/5.384b96a2.js"><link rel="prefetch" href="/assets/js/6.d92e70ec.js"><link rel="prefetch" href="/assets/js/7.32d6a08a.js"><link rel="prefetch" href="/assets/js/8.c0deadc6.js"><link rel="prefetch" href="/assets/js/9.ba718ca8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7da46759.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">hen's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">
  笔记
</a></div><div class="nav-item"><a href="/works/Koa+Vue2+Mysql博客系统.html" class="nav-link">
  作品
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://gitee.com/hen128" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notes/" class="nav-link router-link-active">
  笔记
</a></div><div class="nav-item"><a href="/works/Koa+Vue2+Mysql博客系统.html" class="nav-link">
  作品
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><a href="https://gitee.com/hen128" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架/库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML/CSS/JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>工具</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notes/tool/Git.html" class="sidebar-link">Git</a></li><li><a href="/notes/tool/VsCode.html" class="sidebar-link">VsCode</a></li><li><a href="/notes/tool/Typora图片上传gitee.html" class="sidebar-link">Typora图片上传gitee</a></li><li><a href="/notes/tool/Nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/notes/tool/PM2.html" aria-current="page" class="active sidebar-link">PM2</a></li><li><a href="/notes/tool/宝塔面板.html" class="sidebar-link">宝塔面板</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>另外</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pm2"><a href="#pm2" class="header-anchor">#</a> PM2</h1> <p><img src="https://gitee.com/hen128/storage/raw/master/typora/2022-12-30%20201932.png" alt="image-20221230201930777"></p> <blockquote><p>pm2是一个进程管理工具,可以用它来管理你的node进程，并查看node进程的状态，当然也支持性能监控，进程守护，负载均衡等功能</p></blockquote> <p>安装</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i pm2 <span class="token parameter variable">-g</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>常用命令</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>pm2 start app.js or
pm2 start config.json 启动应用程序

pm2 list 列表所有应用程序

pm2 logs
pm2 logs xxx 查看日志

pm2 stop xxx
pm2 stop all 停止

pm2 restart xxx 重启

pm2 reload all 热加载允许在不停机的情况下更新应用程序

pm2 delete xxx 关闭并删除
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>配置<code>创建xxx.json</code></p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;apps&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wuwu&quot;</span><span class="token punctuation">,</span>                             <span class="token comment">// 项目名          </span>
        <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/www&quot;</span><span class="token punctuation">,</span>                      <span class="token comment">// 执行文件</span>
        <span class="token property">&quot;cwd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span>                                <span class="token comment">// 根目录</span>
        <span class="token property">&quot;args&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                                 <span class="token comment">// 传递给脚本的参数</span>
        <span class="token property">&quot;interpreter&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                          <span class="token comment">// 指定的脚本解释器</span>
        <span class="token property">&quot;interpreter_args&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                     <span class="token comment">// 传递给解释器的参数</span>
        <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                              <span class="token comment">// 是否监听文件变动然后重启</span>
        <span class="token property">&quot;ignore_watch&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>                           <span class="token comment">// 不用监听的文件</span>
            <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
            <span class="token string">&quot;logs&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;exec_mode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cluster_mode&quot;</span><span class="token punctuation">,</span>                <span class="token comment">// 应用启动模式，支持fork和cluster模式</span>
        <span class="token property">&quot;instances&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>                             <span class="token comment">// 应用启动实例个数，仅在cluster模式有效 默认为fork；或者 max</span>
        <span class="token property">&quot;max_memory_restart&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>                    <span class="token comment">// 最大内存限制数，超出自动重启</span>
        <span class="token property">&quot;error_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./logs/app-err.log&quot;</span><span class="token punctuation">,</span>         <span class="token comment">// 错误日志文件</span>
        <span class="token property">&quot;out_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./logs/app-out.log&quot;</span><span class="token punctuation">,</span>           <span class="token comment">// 正常日志文件</span>
        <span class="token property">&quot;merge_logs&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                         <span class="token comment">// 设置追加日志而不是新建日志</span>
        <span class="token property">&quot;log_date_format&quot;</span><span class="token operator">:</span> <span class="token string">&quot;YYYY-MM-DD HH:mm:ss&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 指定日志文件的时间格式</span>
        <span class="token property">&quot;min_uptime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;60s&quot;</span><span class="token punctuation">,</span>                        <span class="token comment">// 应用运行少于时间被认为是异常启动</span>
        <span class="token property">&quot;max_restarts&quot;</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>                         <span class="token comment">// 最大异常重启次数，即小于min_uptime运行时间重启次数；</span>
        <span class="token property">&quot;autorestart&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>                        <span class="token comment">// 默认为true, 发生异常的情况下自动重启</span>
        <span class="token property">&quot;cron_restart&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>                         <span class="token comment">// crontab时间格式重启应用，目前只支持cluster模式;</span>
        <span class="token property">&quot;restart_delay&quot;</span><span class="token operator">:</span> <span class="token string">&quot;60s&quot;</span>                      <span class="token comment">// 异常重启情况下，延时重启时间</span>
        <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
           <span class="token property">&quot;NODE_ENV&quot;</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span><span class="token punctuation">,</span>                <span class="token comment">// 环境参数，当前指定为生产环境 process.env.NODE_ENV</span>
           <span class="token property">&quot;REMOTE_ADDR&quot;</span><span class="token operator">:</span> <span class="token string">&quot;爱上大声地&quot;</span>               <span class="token comment">// process.env.REMOTE_ADDR</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;env_dev&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;NODE_ENV&quot;</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>              <span class="token comment">// 环境参数，当前指定为开发环境 pm2 start app.js --env_dev</span>
            <span class="token property">&quot;REMOTE_ADDR&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;env_test&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>                               <span class="token comment">// 环境参数，当前指定为测试环境 pm2 start app.js --env_test</span>
            <span class="token property">&quot;NODE_ENV&quot;</span><span class="token operator">:</span> <span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;REMOTE_ADDR&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notes/tool/Nginx.html" class="prev">
        Nginx
      </a></span> <span class="next"><a href="/notes/tool/宝塔面板.html">
        宝塔面板
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.34c958b8.js" defer></script><script src="/assets/js/2.72a95a92.js" defer></script><script src="/assets/js/21.d320b7b1.js" defer></script>
  </body>
</html>
